<!DOCTYPE html>
<html lang="en">

<head>

    <!-- #region Sabio Code - You can Fold this region to remove it from sight -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="Sabio Coding Bootcamp" />
    <meta itemprop="image" content="https://sabio.la/Sabio.png">
    <link rel="shortcut icon" href="https://sabio.la/Sabio.png">
    <link rel="icon" type="image/png" href="https://sabio.la/Sabio.png" />

    <!-- Do Not Change the HTML title or anything between this line and the line with the ðŸ’˜'s -->
    <title>Register</title>
    <link href="https://pw.sabio.la/dist/all-site.css" rel="stylesheet" />
    <script src="https://pw.sabio.la/api/js/site"></script>
    <script src="https://unpkg.com/axios@0.19.2/dist/axios.min.js"></script>
    <script src="services/userServices.js"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js'></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.css" rel='stylesheet'>


    <!-- #endregion -->
    <!-- I ðŸ’˜ Code, You ðŸ’˜ Code, We all ðŸ’˜ Code -->

    <!-- ðŸ’¡ All your CSS in here -->
    <style>
        form {
            margin-left: 25%;
            margin-top: 10%;
            padding: 10px;
        }

        button {
            margin-left: 15px
        }
    </style>
</head>

<body class="sabio" data-ins="pw-00">


    <!-- Do Not Edit or Remove this nav element -->
    <nav class="do-not-remove navbar d-none navbar-expand-md navbar-dark bg-dark sabio"></nav>

    <ul class='nav nav-tabs'>

        <li class='nav-item'>
            <a class='nav-link' href='Home.html'>Home</a>
        </li>
        <li class='nav-item'>
            <a class='nav-link' href='Friends.html'>Friends</a>
        </li>
        <li class='nav-item'>
            <a class='nav-link' href='Blogs.html'>Blogs</a>
        </li>
        <li class='nav-item'>
            <a class='nav-link' href='Companies.html'>Tech Companies</a>
        </li>
        <li class='nav-item'>
            <a class='nav-link' href='Jobs.html'>Jobs</a>
        </li>
        <li class='nav-item'>
            <a class='nav-link' href='Events.html'>Events</a>
        </li>
        <li class='nav-item'>
            <a class='nav-link active' href='Register.html'>Register</a>
        </li>
    </ul>
    <div class='container' id='formContainer'>
        <form>
            <div class='form-group col-6'>
                <label for='firstName'>First Name</label>
                <input type='text' class='form-control' id='firstName' placeholder="At least 2 characters">
            </div>
            <div class='form-group col-6'>
                <label for='lastName'>Last Name</label>
                <input type='text' class='form-control' id='lastName' placeholder="At least 2 characters">
            </div>
            <div class='form-group col-6'>
                <label for='email'>Email</label>
                <input type='email' class='form-control' id='userEmail'>
            </div>
            <div class='form-group col-6'>
                <label for='password'>Password</label>
                <input type='password' class='form-control' id='password'>
            </div>
            <div class='form-group col-6'>
                <label for='passwordConfirm'>Confirm Password</label>
                <input type='password' class='form-control' id='passwordConfirm'>
            </div>
            <div class='form-group col-6'>
                <label for='avatar'>Avatar Url</label>
                <input type='link' class='form-control' id='avatar'>
            </div>
            <button type='submit' class='btn btn-primary' id='submitButton'>Submit</button>
            <a href='Login.html' class='btn btn-primary'>Login</a>
        </form>
    </div>


    <!-- Do Not Edit or Remove this footer element -->
    <footer class="do-not-remove container-fluid footer mx-auto  fb-targert sabio">
        <p class="text-center">Â© Sabio.la 2019</p>
    </footer>

    <!--ðŸ‘‡ðŸ» All your JavaScript code goes below here inside this script tag ðŸ‘‡ðŸ» -->
    <script id="candidateCode">
        function startUp() {
            wireUpHandlers();
        }
        function wireUpHandlers() {
            $('#submitButton').on('click', submitForm)
        }
        function submitForm(e) {
            e.preventDefault();
            var payload = createUserObject();
            registerUser(payload)
                .then(onRegisterSuccess)
                .catch(onRegisterError)

        }

        function createUserObject() {
            let result = {
                'firstName': $('#firstName').val(),
                'lastName': $('#lastName').val(),
                'email': $('#userEmail').val(),
                'password': $('#password').val(),
                'passwordConfirm': $('#passwordConfirm').val(),
                'avatarUrl': $('#avatar').val(),
                'tenantId': 'U012YNYNGAW'
            }
            return result;
        }

        function onRegisterSuccess() {
            logIn({
                email: $('#userEmail').val(),
                password: $('#password').val(),
                tenantId: "U012YNYNGAW"
            }).then(onLoginSuccess).catch(onLoginError)
        };
        function onRegisterError(response) {
            var errors = response.response.data.errors;
            var errorArr = [];
            for (let index = 0; index < errors.length; index++) {
                const currentError = errors[index];


                if (currentError.includes('must be')) {

                }
                else { errorArr.push(`<p>&bull;${currentError}</p>`) }
            }

            return toastr['error'](errorArr)

        }

        function onLoginSuccess() {
            window.location.replace('Home.html')
        }
        function onLoginError() {
            return;
        }



    </script>
    <!-- ðŸ›‘ Do Not Write Any Code Below here -->
</body>

</html>